getwd()
# read data ---------------------------------------------------------------
#import shapefile again
lsoa_wales_2011Polygon_projected <- readRDS("cache/lsoa_wales_2011Polygon_projected.rds")
# read data ---------------------------------------------------------------
#import shapefile again
lsoa_wales_2011Polygon_projected <- readRDS("data/lsoa_wales_2011Polygon_projected.rds")
#import wimd data
wimd <- readRDS("data/dataView2445.78.rds")
View(wimd)
pal <- colorNumeric(
palette = "viridis",
domain =  primary_sf$percent_fsm_eligible_3_year_average,
reverse = TRUE)
# call packages -----------------------------------------------------------
library(pacman)
??colorNumeric
p_load(leaflet, magrittr)
class(wimd)
View(wimd)
class(lsoa_wales_2011Polygon_projected)
pal <- colorNumeric(
palette = "viridis",
domain =  primary_sf$percent_fsm_eligible_3_year_average,
reverse = TRUE)
View(wimd)
pal <- colorNumeric(
palette = "viridis",
domain =  wimd$overall_rank_2019,
reverse = TRUE)
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite")
interactive_map
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 1.0, fillOpacity = 0.5,
#fillColor = ~colorFactor('Purples', wimd$quintile_1)(wimd$quintile_1),
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
interactive_map
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 1.0, fillOpacity = 0.5,
#fillColor = ~colorFactor('Purples', wimd$quintile_1)(wimd$quintile_1),
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
)
interactive_map
#create map
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 1.0, fillOpacity = 0.5,
#fillColor = ~colorFactor('Purples', wimd$quintile_1)(wimd$quintile_1),
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 9) %>%
addLayersControl(
options = layersControlOptions(collapsed = FALSE),
baseGroups = c("Toner Lite", "Open Street Map"),
overlayGroups = c("Schools", "LSOAs")
)
interactive_map
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 1.0, fillOpacity = 0.5,
#fillColor = ~colorFactor('Purples', wimd$quintile_1)(wimd$quintile_1),
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 9) %>%
addLayersControl(
options = layersControlOptions(collapsed = FALSE),
baseGroups = c("Toner Lite", "Open Street Map")
)
interactive_map
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 1.0, fillOpacity = 0.5,
#fillColor = ~colorFactor('Purples', wimd$quintile_1)(wimd$quintile_1),
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 7) %>%
addLayersControl(
options = layersControlOptions(collapsed = FALSE),
baseGroups = c("Toner Lite", "Open Street Map")
)
interactive_map
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 1.0, fillOpacity = 0.5,
#fillColor = ~colorFactor('Purples', wimd$quintile_1)(wimd$quintile_1),
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8) %>%
addLayersControl(
options = layersControlOptions(collapsed = FALSE),
baseGroups = c("Toner Lite", "Open Street Map")
)
interactive_map
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 0.7, fillOpacity = 0.5,
#fillColor = ~colorFactor('Purples', wimd$quintile_1)(wimd$quintile_1),
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8) %>%
addLayersControl(
options = layersControlOptions(collapsed = FALSE),
baseGroups = c("Toner Lite", "Open Street Map")
)
interactive_map
interactive_map <- leaflet() %>%
addTiles(group = "Open Street Map") %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 0.5, fillOpacity = 0.5,
#fillColor = ~colorFactor('Purples', wimd$quintile_1)(wimd$quintile_1),
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8) %>%
addLayersControl(
options = layersControlOptions(collapsed = FALSE),
baseGroups = c("Toner Lite", "Open Street Map")
)
interactive_map
interactive_map <- leaflet() %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 0.5, fillOpacity = 0.5,
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8) %>%
addLayersControl(
options = layersControlOptions(collapsed = FALSE),
baseGroups = c("Toner Lite", "Open Street Map")
)
interactive_map
interactive_map <- leaflet() %>%
addProviderTiles("Stamen.TonerLite", group = "Toner Lite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
group = "LSOAs",
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 0.5, fillOpacity = 0.5,
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8)
interactive_map
interactive_map <- leaflet() %>%
#add tiles to map
addProviderTiles("Stamen.TonerLite") %>%
addPolygons(
data = lsoa_wales_2011Polygon_projected,
color = "#444444", weight = 1, smoothFactor = 0.5,
opacity = 0.5, fillOpacity = 0.5,
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8)
interactive_map
View(lsoa_wales_2011Polygon_projected)
interactive_map <- leaflet() %>%
#add tiles to map
addProviderTiles("Stamen.TonerLite") %>%
#add chloropleth
addPolygons(
#use geometry from sf
data = lsoa_wales_2011Polygon_projected,
#color = "#444444",
weight = 1,
smoothFactor = 0.5,
opacity = 0.5, fillOpacity = 0.5,
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8)
interactive_map
interactive_map <- leaflet() %>%
#add tiles to map
addProviderTiles("Stamen.TonerLite") %>%
#add chloropleth
addPolygons(
#use geometry from sf
data = lsoa_wales_2011Polygon_projected,
#boundary lines to grey hex code
color = "#444444",
#specify boundary line weight
weight = 1,
#
#smoothFactor = 0.5,
opacity = 0.5, fillOpacity = 0.5,
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8)
interactive_map
source('~/Documents/grad_intro2Shiny/map_columns/function.R', echo=TRUE)
interactive_map <- leaflet() %>%
#add tiles to map
addProviderTiles("Stamen.TonerLite") %>%
#add chloropleth
addPolygons(
#use geometry from sf
data = lsoa_wales_2011Polygon_projected,
#boundary lines to grey hex code
color = "#444444",
#specify boundary line weight
weight = 1,
#specify the degree of smoothing to the lsoa polygons
smoothFactor = 0.5,
#set opacity of boundary lines
opacity = 0.5,
#set opacity of polygon fill
fillOpacity = 0.5,
#control the colour of the polygon fill
fillColor = ~colorFactor('viridis', wimd$quintile_1),
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8)
interactive_map
View(wimd)
interactive_map <- leaflet() %>%
#add tiles to map
addProviderTiles("Stamen.TonerLite") %>%
#add chloropleth
addPolygons(
#use geometry from sf
data = lsoa_wales_2011Polygon_projected,
#boundary lines to grey hex code
color = "#444444",
#specify boundary line weight
weight = 1,
#specify the degree of smoothing to the lsoa polygons
smoothFactor = 0.5,
#set opacity of boundary lines
opacity = 0.5,
#set opacity of polygon fill
fillOpacity = 0.5,
#control the colour of the polygon fill
fillColor = ~colorFactor('viridis', wimd$quintile_1)(wimd$quintile_1),
#control the behaviour on hover
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
popup = ~wimd$quintile_1
) %>%
setView(lng = -3.8, lat = 52.5, zoom = 8)
interactive_map
# create map --------------------------------------------------------------
#function that takes a sf shapefile & also a variable dataframe column to
#colour by & contorl popup info
colour_by_column <- function(shapefile, dataframe_column){
#create map
interactive_map <- leaflet() %>%
#add tiles to map
addProviderTiles("Stamen.TonerLite") %>%
#add chloropleth
addPolygons(
#use geometry from sf
data = shapefile,
#boundary lines to grey hex code
color = "#444444",
#specify boundary line weight
weight = 1,
#specify the degree of smoothing to the lsoa polygons
smoothFactor = 0.5,
#set opacity of boundary lines
opacity = 0.5,
#set opacity of polygon fill
fillOpacity = 0.5,
#control the colour of the polygon fill
fillColor = ~colorFactor('viridis', dataframe_column)(dataframe_column),
#control the behaviour on hover
highlightOptions = highlightOptions(color = "white", weight = 2,
bringToFront = F),
#info on click
popup = ~dataframe_column
) %>%
#set the starting view
setView(lng = -3.8, lat = 52.5, zoom = 8)
#call the map
interactive_map
}
View(wimd)
colour_by_column(shapefile = lsoa_wales_2011Polygon_projected,
dataframe_column = wimd[, 3])
colour_by_column(shapefile = lsoa_wales_2011Polygon_projected,
dataframe_column = wimd[, 4])
colour_by_column(shapefile = lsoa_wales_2011Polygon_projected,
dataframe_column = wimd$overall_rank_2019)
#and another column
colour_by_column(shapefile = lsoa_wales_2011Polygon_projected,
dataframe_column = wimd$quintile)
